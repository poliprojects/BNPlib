p1
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")
p1=p1+geom_line(data = density1, aes(x = V1, y = V2,col = 'den'))
p1=p1+geom_line(data = components, aes(x = V1, y = a, col = 'a'))
p1=p1+geom_line(data = components, aes(x = V1, y = b, col = "b"))
p1=p1+geom_line(data = components, aes(x = V1, y = c, col = "c"))
p1=p1+geom_line(data = components, aes(x = V1, y = d, col = "d"))
p1=p1+
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('den'="red",'a'="yellow", 'b'="orange", 'c'="green",'d'= "blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of component 1", "Density of component 2", "Density of component 3"))
p1
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")
p1=p1+geom_line(data = density1, aes(x = V1, y = V2,col = "den"))
p1=p1+geom_line(data = components, aes(x = V1, y = a, col = "a"))
p1=p1+geom_line(data = components, aes(x = V1, y = b, col = "b"))
p1=p1+geom_line(data = components, aes(x = V1, y = c, col = "c"))
p1=p1+geom_line(data = components, aes(x = V1, y = d, col = "d"))
p1=p1+
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('den'="red",'a'="yellow", 'b'="orange", 'c'="green",'d'= "blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of component 1", "Density of component 2", "Density of component 3"))
p1
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")
p1=p1+geom_line(data = density1, aes(x = V1, y = V2,col = "den"))
p1=p1+geom_line(data = components, aes(x = V1, y = a, col = "a"))
p1=p1+geom_line(data = components, aes(x = V1, y = b, col = "b"))
p1=p1+geom_line(data = components, aes(x = V1, y = c, col = "c"))
p1=p1+geom_line(data = components, aes(x = V1, y = d, col = "d"))
p1=p1+
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c("den"="red",'a'="yellow", 'b'="orange", 'c'="green",'d'= "blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of component 1", "Density of component 2", "Density of component 3"))
p1
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")
p1=p1+geom_line(data = density1, aes(x = V1, y = V2,col = "red"))
p1=p1+geom_line(data = components, aes(x = V1, y = a, col = "yellow"))
p1=p1+geom_line(data = components, aes(x = V1, y = b, col = "orange"))
p1=p1+geom_line(data = components, aes(x = V1, y = c, col = "green"))
p1=p1+geom_line(data = components, aes(x = V1, y = d, col = "blue"))
p1=p1+
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c("red","yellow", "orange", "green", "blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of component 1", "Density of component 2", "Density of component 3"))
p1
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")
p1=p1+geom_line(data = density1, aes(x = V1, y = V2,col = '1'))
p1=p1+geom_line(data = components, aes(x = V1, y = a, col = '2'))
p1=p1+geom_line(data = components, aes(x = V1, y = b, col = '3'))
p1=p1+geom_line(data = components, aes(x = V1, y = c, col = '4'))
p1=p1+geom_line(data = components, aes(x = V1, y = d, col = '5'))
p1=p1+
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of component 1", "Density of component 2", "Density of component 3"))
p1
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='skyblue',fill='steelblue')
p2
table(clust_final1[,3])
View(clust_final1)
View(data)
p1
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")
p1=p1+geom_line(data = density1, aes(x = V1, y = V2,col = '1'))
p1=p1+geom_line(data = components, aes(x = V1, y = a, col = '2'))
p1=p1+geom_line(data = components, aes(x = V1, y = b, col = '3'))
p1=p1+geom_line(data = components, aes(x = V1, y = c, col = '4'))
p1=p1+geom_line(data = components, aes(x = V1, y = d, col = '5'))
p1=p1+
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")
+geom_line(data = density1, aes(x = V1, y = V2,col = '1'))
+geom_line(data = components, aes(x = V1, y = a, col = '2'))
+geom_line(data = components, aes(x = V1, y = b, col = '3'))
+geom_line(data = components, aes(x = V1, y = c, col = '4'))
+geom_line(data = components, aes(x = V1, y = d, col = '5'))
+
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density1, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of component 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='skyblue',fill='steelblue')
p2
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='red',fill='orange')
p2
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='red',fill='orange') +
geom_text(aes(label=Number), position=position_dodge(width=0.9), vjust=-0.25)
p2
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='red',fill='orange') +
geom_text(aes(label= "aa"))
p2
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='red',fill='orange') +
+ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Frequency")
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='red',fill='orange') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Frequency")
p2
dat
table(clust_final1[,3])
dat[,2]=dat[,2]/100
dat
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='red',fill='orange') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Frequency")
dat
p2
g <- rbind(p1,p2)
grid.newpage()
grid.draw(g)
library(gtable)
g <- rbind(p1,p2)
grid.newpage()
grid.draw(g)
g
g <- rbind(p1, p2, size = "first")
grid.newpage()
grid.draw(g)
ggarrange(p1, p2, widths = c(1.5,2))
detach("package:gridExtra", unload = TRUE)
library(gridExtra)
ggarrange(p1, p2, widths = c(1.5,2))
grid.arrange(p1, p2, widths = c(1.5,2))
grid.arrange(p1, p2, widths = c(2.5,2))
grid.arrange(p1, p2, widths = c(3,2))
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='red',fill='gray') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Frequency")
grid.arrange(p1, p2, widths = c(3,2))
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='black',fill='gray') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Frequency")
grid.arrange(p1, p2, widths = c(3,2))
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='black',fill='gray') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Relative frequency")
grid.arrange(p1, p2, widths = c(3,2))
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density1, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of cluster 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='black',fill='gray') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Relative frequency")
grid.arrange(p1, p2, widths = c(3,2))
library(ggplot2)
data= as.numeric(read.csv("data.csv", sep=",", header=F))[1:100]
density5= read.csv("density5.csv", sep=",", header=F) #24 clusters
density1= read.csv("density1.csv", sep=",", header=F) #9 clusters
density035= read.csv("density035.csv", sep=",", header=F) # 1 cluster
h<-hist(data, plot=F)
h$counts <- h$counts / sum(h$counts)
x11()
plot(h, freq=TRUE, ylab="Relative Frequency", ylim=c(0,0.4), xlim=c(0,10))
lines(density5[,1], density5[,2], col="green",  lwd = 1.5)
lines(density1[,1], density1[,2], col="red",  lwd = 1.5)
lines(density035[,1], density035[,2], col="blue",  lwd = 1.5)
legend("topright",  c("Estimated posterior density with:", "M=0.35", "M=1.0", "M=5.0"),
lty=c(0,1,1,1),
col=c("blue","red", "green"))
clust_best035= read.csv("clust_best035.csv", sep=",", header=F)
clust_final035= read.csv("clust_final035.csv", sep=",", header=F)
hist(clust_final035[,3])
View(clust_best035)
clust_best1= read.csv("clust_best1.csv", sep=",", header=F)
clust_final1= read.csv("clust_final1.csv", sep=",", header=F)
hist(clust_best1[,3])
hist(clust_final1[,3])
hist(clust_best1[,3])
clust_best5= read.csv("clust_best5.csv", sep=",", header=F)
clust_final5= read.csv("clust_final5.csv", sep=",", header=F)
View(clust_final035)
View(clust_best035)
View(clust_best1)
a=log(dnorm(density1[,1],mean=4.81909	,sd=sqrt(1.672570))) #0
b=log(dnorm(density1[,1],mean=5.26594, sd=sqrt(2.783170))) #1
c=log(dnorm(density1[,1],mean=5.17475	, sd=sqrt(1.166610))) #2
d=log(dnorm(density1[,1],mean=4.67092, sd=sqrt(0.349494))) #3
dat=data.frame(table(clust_final1[,3]))
dat[,2]=dat[,2]/100
#v=c(1:100)
#v[1:50]="red"
#v[51:100]="orange"
data=data.frame(data)
components=data.frame(density1[,1], a,b,c,d)
names(components)[names(components) == "density1...1."] <- "V1"
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density1, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of cluster 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1
a=ln(dnorm(density1[,1],mean=4.81909	,sd=sqrt(1.672570))) #0
dnorm(density1[,1],mean=4.81909	,sd=sqrt(1.672570))
a=dnorm(density1[,1],mean=4.81909	,sd=sqrt(1.672570)) #0
b=dnorm(density1[,1],mean=5.26594, sd=sqrt(2.783170)) #1
c=dnorm(density1[,1],mean=5.17475	, sd=sqrt(1.166610)) #2
d=dnorm(density1[,1],mean=4.67092, sd=sqrt(0.349494)) #3
dat=data.frame(table(clust_final1[,3]))
dat[,2]=dat[,2]/100
#v=c(1:100)
#v[1:50]="red"
#v[51:100]="orange"
data=data.frame(data)
components=data.frame(density1[,1], a,b,c,d)
names(components)[names(components) == "density1...1."] <- "V1"
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density1, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of cluster 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1
View(clust_best035)
View(clust_best5)
View(clust_best1)
density05= read.csv("density05.csv", sep=",", header=F) # 1 cluster
clust_best05= read.csv("clust_best05.csv", sep=",", header=F)
clust_final05= read.csv("clust_final05.csv", sep=",", header=F)
View(density05)
View(clust_best05)
a=dnorm(density05[,1],mean=3.99921,	sd=sqrt(0.190563))#0
b=dnorm(density05[,1],mean=	4.91478,	sd=sqrt(	0.193248)) #1
c=dnorm(density05[,1],mean=5.72031, 	sd=sqrt(0.255756)) #2
d=dnorm(density05[,1],mean=	5.24423, 	sd=sqrt(3.621910) )#3
dat=data.frame(table(clust_best05[,3]))
View(dat)
dat[,2]=dat[,2]/100
data=data.frame(data)
components=data.frame(density05[,1], a,b,c,d)
names(components)
names(components)[names(components) == "density05...1."] <- "V1"
names(components)
View(density05)
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density05, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of cluster 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='black',fill='gray') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Relative frequency")
p1
a=dnorm(density05[,1],mean=3.99921,	sd=0.190563)#0
b=dnorm(density05[,1],mean=	4.91478,	sd=0.193248) #1
c=dnorm(density05[,1],mean=5.72031, 	sd=0.255756) #2
d=dnorm(density05[,1],mean=	5.24423, 	sd=3.621910)#3
dat=data.frame(table(clust_best05[,3]))
dat[,2]=dat[,2]/100
components=data.frame(density05[,1], a,b,c,d)
names(components)[names(components) == "density05...1."] <- "V1"
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density05, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of cluster 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1
grid.arrange(p1, p2, widths = c(3,2))
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='black',fill='gray') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Relative frequency")
library(gridExtra)
grid.arrange(p1, p2, widths = c(3,2))
setwd("C:/Users/EzioGreggio/Desktop/density_prog/num_clust_M")
num_clust= as.numeric(read.csv("num_clust_best.csv", sep=",", header=F))
mass= as.numeric(read.csv("values_mass.csv", sep=",", header=F))
plot(mass,num_clust)
df=data.frame(mass,num_clust)
library(ggplot2)
ggplot(df,aes(x=mass, y=num_clust))
g_line(df,aes(x=mass, y=num_clust))
geom_line((df,aes(x=mass, y=num_clust))
geom_line(df,aes(x=mass, y=num_clust))
ggplot(df,aes(x=mass, y=num_clust))+
geom_line()+
geom_point()
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()
df=data.frame(mass,num_clust)
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()
ggtitle("Number of Cluster in function of the total mass M") +
xlab("M") + ylab("n. of clusters")
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of Cluster in function of the total mass M") +
xlab("M") + ylab("n. of clusters")
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of clusters in function of the total mass M") +
xlab("M") + ylab("n. of clusters")
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of clusters in function of the total mass M") +
xlab("M") + ylab("n. clusters")
setwd("C:/Users/EzioGreggio/Desktop/density_prog/neal2")
data= as.numeric(read.csv("data.csv", sep=",", header=F))[1:100]
h<-hist(data, plot=F)
h$counts <- h$counts / sum(h$counts)
x11()
plot(h, freq=TRUE, ylab="Relative Frequency", ylim=c(0,0.4), xlim=c(0,10))
density= read.csv("density.csv", sep=",", header=F)
x11()
plot(h, freq=TRUE, ylab="Relative Frequency", ylim=c(0,0.4), xlim=c(0,10))
lines(density[,1], density[,2], col="green",  lwd = 1.5)
density= read.csv("density.csv", sep=",", header=F)
x11()
plot(h, freq=TRUE, ylab="Relative Frequency", ylim=c(0,0.4), xlim=c(0,10))
lines(density[,1], density[,2], col="green",  lwd = 1.5)
best_clust= read.csv("best_clust.csv", sep=",", header=F)
final_clust= read.csv("final_clust.csv", sep=",", header=F)
x11()
plot(h, freq=TRUE, ylab="Relative Frequency", ylim=c(0,0.4), xlim=c(0,10))
lines(density[,1], density[,2], col="green",  lwd = 1.5)
lines(density1[,1], density1[,2], col="red",  lwd = 1.5)
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of clusters in function of the total mass M") +
xlab("M") + ylab("n. clusters")
View(clust_best1)
View(clust_final1)
View(clust_best5)
View(clust_final5)
table(clust_final5[,3])
table(clust_best5[,3])
View(density05)
table(clust_best1[,3])
table(clust_final1[,3])
table(clust_final05[,3])
table(clust_best05[,3])
table(clust_best035[,3])
table(clust_final035[,3])
hist(clust_final035[,3])
hist(clust_best5[,3])
hist(clust_final5[,3])
hist(clust_best5[,3])
hist(clust_best05[,3])
hist(clust_final05[,3])
setwd("C:/Users/EzioGreggio/Desktop/density_prog/num_clust_M")
num_clust_best= as.numeric(read.csv("num_clust_best.csv", sep=",", header=F))
num_clust_fin= as.numeric(read.csv("num_clusters_final.csv", sep=",", header=F))
num_clust=num_clust_fin
mass= as.numeric(read.csv("values_mass.csv", sep=",", header=F))
plot(mass,num_clust)
df=data.frame(mass,num_clust)
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of clusters in function of the total mass M") +
xlab("M") + ylab("n. clusters")
num_clust=num_clust_best
mass= as.numeric(read.csv("values_mass.csv", sep=",", header=F))
plot(mass,num_clust)
df=data.frame(mass,num_clust)
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of clusters in function of the total mass M") +
xlab("M") + ylab("n. clusters")
View(best_clust)
num_clust
num_clust_best= as.numeric(read.csv("num_clust_best.csv", sep=",", header=F))[1:10]
#num_clust_fin= as.numeric(read.csv("num_clusters_final.csv", sep=",", header=F))[1:10]
num_clust=num_clust_best
mass= as.numeric(read.csv("values_mass.csv", sep=",", header=F))
plot(mass,num_clust)
df=data.frame(mass,num_clust)
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of clusters in function of the total mass M") +
xlab("M") + ylab("n. clusters")
mass
mass= as.numeric(read.csv("values_mass.csv", sep=",", header=F))[1:10]
plot(mass,num_clust)
df=data.frame(mass,num_clust)
ggplot(df,aes(x=mass, y=num_clust))+
geom_line(linetype = "dashed")+
geom_point()+
ggtitle("Number of clusters in function of the total mass M") +
xlab("M") + ylab("n. clusters")
data= as.numeric(read.csv("data.csv", sep=",", header=F))[1:100]
density= read.csv("density.csv", sep=",", header=F)
h<-hist(data, plot=F)
h$counts <- h$counts / sum(h$counts)
best_clust= read.csv("best_clust.csv", sep=",", header=F)
final_clust= read.csv("final_clust.csv", sep=",", header=F)
hist(clust_final035[,3])
x11()
plot(h, freq=TRUE, ylab="Relative Frequency", ylim=c(0,0.4), xlim=c(0,10))
lines(density[,1], density[,2], col="green",  lwd = 1.5)
lines(density1[,1], density1[,2], col="red",  lwd = 1.5)
View(clust_best1)
View(clust_final1)
a=dnorm(density1[,1],mean=	4.81909, sd=	1.672570)#0
b=dnorm(density1[,1],mean=	5.26594, sd=	2.783170) #1
c=dnorm(density1[,1],mean=5.17475, sd	1.166610) #2
d=dnorm(density1[,1],mean=	4.67092, sd=	0.349494)#3
dat=data.frame(table(clust_final1[,3]))
dat
dat[,2]=dat[,2]/100
dat[,2]
data=data.frame(data)
components=data.frame(density1[,1], a,b,c,d)
names(components)
names(components)[names(components) == "density1...1."] <- "V1"
names(components)
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density1, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of cluster 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1
p2=ggplot(data = dat, aes(x = reorder(Var1, -Freq), Freq)) +
geom_bar(stat = "identity", color='black',fill='gray') +
ggtitle("Barplot of Clusters") +
xlab("Clusters") + ylab("Relative frequency")
grid.arrange(p1, p2, widths = c(3,2))
a=dnorm(density1[,1],mean=	4.81909, sd=	1.672570)#0
b=dnorm(density1[,1],mean=	5.26594, sd=	2.783170) #1
c=dnorm(density1[,1],mean=5.17475, sd	=1.166610) #2
d=dnorm(density1[,1],mean=	4.67092, sd=	0.349494)#3
dat=data.frame(table(clust_final1[,3]))
dat[,2]=dat[,2]/100
#v=c(1:100)
#v[1:50]="red"
#v[51:100]="orange"
data=data.frame(data)
components=data.frame(density1[,1], a,b,c,d)
names(components)[names(components) == "density1...1."] <- "V1"
p1=ggplot(data, aes(x=data)) +geom_histogram(aes(y=..density..),binwidth=0.75, fill="white", color="black")+
geom_line(data = density1, aes(x = V1, y = V2,col = '1'))+
geom_line(data = components, aes(x = V1, y = a, col = '2')) +
geom_line(data = components, aes(x = V1, y = b, col = '3')) +
geom_line(data = components, aes(x = V1, y = c, col = '4')) +
geom_line(data = components, aes(x = V1, y = d, col = '5')) +
ggtitle("Estimated posterior density")  +
xlab("data") +
ylab("Relative frequency") +scale_color_manual(name="",values =c('1'="red",'2'="yellow",'3'= "orange", '4'= "green", '5'="blue"),
labels = c("Estimated posterior density", "Density of cluster 0", "Density of cluster 1", "Density of cluster 2", "Density of cluster 3"))
p1
plot(d)
p1
