\section{Algorithm factory}
For a runtime choice of the BNP algorithm we implemented the Factory class.
An object factory allows to choose one of several derived objects from a single abstract base class at runtime.  This type of class is implemented as a singleton and stores functions that build such objects, called the builders, which can be called at need at runtime, based on identifiers of the specific objects. The storage, a private member of the factory class, is therefore an Identifier-Builder map where the identifier is a string associated with the builder function.
 The storage must first be filled with the appropriate builders, which can be as simple as a function returning a smart pointer to a new instance. This can be done in a main file or in an appropriate function.
Since the constructors of BNP algorithms take different parameters in input, we chose to templatized the factory, in addition to the abstract product, with a variadic template, that allows passing any number of parameters of any type to the constructors of the objects.
Theoretically it is possible to use the same Factory class to produce different types of objects, since templates specialized with different arguments (AbstractProduct) are treated as different objects.
However, the abstract product, in our case one of two derived algorithms, \verb|Neal2| or \verb|Neal8|, is defined with specific hierarchy, mixture, and hyperparameters classes which must be known at compile time. Having base classes for hierarchy and mixture, it would be possible to choose them at runtime, but it would require to add to the factory storage all possible combinations of algorithms, hierarchies,and mixtures.
This is possible with the current number of available objects, but as the library expands with new classes being added this method would not scale well.
At the moment it is therefore runtime the only choice of the BNP algorithm.
In the following section we will talk about the python interface, for a more friendly and versatile use of the code. Thanks to the factory the user can choose directly from the python console the desired algorithm.
